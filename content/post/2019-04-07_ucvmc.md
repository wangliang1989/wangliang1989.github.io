---
title: "南加州地震中心统一社区模型"
date: 2019-04-07T14:24:00+08:00
lastmod: 2019-04-07T14:24:00+08:00
draft: false
tags: ["参考模型"]
categories: ["数据获取"]
author: 王亮
weight: 10
contentCopyright: '<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank">CC 4.0</a>'
mathjax: true
slug:ucvmc
---

南加州地震中心统一社区模型提供的是美国加州的参考模型，下简称加州模型。

# 准备安装环境

加州模型的安装需要 python2 的环境，理论可以在 Linux 和 Mac 上安装，不过我仅在 Linux 上成功。
目前，多数新 python 程序已经是 python3，使用 anaconda 可以临时启用 python2 的环境。
安装 anaconda 可以参考

https://blog.seisman.info/anaconda/

除了 python2，还需要安装 GNU C 和 Fortran，通常这本身已经安装了。

# 下载源码

使用 git 下载源码：

```bash
git clone https://github.com/SCECCode/UCVMC.git
```

# 下载大型数据文件

```bash
cd UCVMC/largefiles
git checkout dev # 如果要使用开发版
conda activate python2 # 激活 python2 环境
./get_large_files.py # 下载大型数据文件
```

数据文件比较大，可能需要较长的时间。数据下载完毕后会显示：

```text
Completed all required downloads. This computer is now ready to build and install the UCVMC programs and scripts.
```

然后，需要检查数据下载是否成功

```bash
./check_largefiles_md5.py
```

如果输出如下，表示下载成功。这个数据检查是用的md5，该脚本在 Mac 上无法使用。

```text
Checked 10 UCVM large files with: 10 OK, and: 0 errors
```

# 安装

```bash
cd .. # 进入UCVMC/
./stage_large_files.py # 移动数据文件
./ucvm_setup.py # 开始安装
```
脚本会询问一些安装问题。安装过程需要较长时间。
安装完毕后，脚本会输出以下类似内容，将其加入环境变量

```text
export LD_LIBRARY_PATH=/home/peterpan/ucvm-17.1.0/lib/euclid3/lib:$LD_LIBRARY_PATH
export LD_LIBRARY_PATH=/home/peterpan/ucvm-17.1.0/lib/proj-4/lib:$LD_LIBRARY_PATH
export LD_LIBRARY_PATH=/home/peterpan/ucvm-17.1.0/model/cvms426/lib:$LD_LIBRARY_PATH
export LD_LIBRARY_PATH=/home/peterpan/ucvm-17.1.0/model/cencal/lib:$LD_LIBRARY_PATH
export PYTHONPATH=${PYTHONPATH}:/home/peterpan/ucvm-17.1.0/utilities:/home/peterpan/ucvm-17.1.0/ucvm-17.1.0/utilities/pycvm
```

然后在安装路径下（不是 git 下载的源码目录）输入以下命令，如果正常输出结果，即表示安装成功。

```bash
./bin/ucvm_query -f ./conf/ucvm.conf -m cvms < ./tests/test_latlons.txt
```
